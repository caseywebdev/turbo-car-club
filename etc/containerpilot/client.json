{
  "consul": "http://consul:8500",
  "preStart": [
    "consul-template",
    "-once",
    "-consul",
    "consul:8500",
    "-template",
    "/code/etc/nginx.conf.ctmpl:/usr/local/nginx/conf/nginx.conf"
  ],
  "services": [
    {
      "name": "client",
      "port": 80,
      "health": "curl --fail -s localhost",
      "poll": 10,
      "ttl": 30
    }
  ],
  "backends": [
    {
      "name": "signal",
      "poll": 10,
      "onChange": [
        "consul-template",
        "-once",
        "-consul",
        "consul:8500",
        "-template",
        "/code/etc/nginx.conf.ctmpl:/usr/local/nginx/conf/nginx.conf:nginx -s reload"
      ]
    }
  ]
}
