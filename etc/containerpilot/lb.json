{
  "consul": "{{ .CONSUL_URL }}:8500",
  "preStart": "/code/bin/lb-pre-start",
  "services": [
    {
      "name": "lb-http",
      "port": 80,
      "health": "curl -fso /dev/null localhost",
      "poll": 10,
      "ttl": 30,
      "consul": {"deregisterCriticalServiceAfter": "90m"}
    },
    {
      "name": "lb-https",
      "port": 443,
      "health": "curl -kfso /dev/null https://localhost",
      "poll": 10,
      "ttl": 30,
      "consul": {"deregisterCriticalServiceAfter": "90m"}
    }
  ],
  "backends": [
    {
      "name": "consul-http",
      "poll": 10,
      "onChange": "/code/bin/lb-on-change"
    },
    {
      "name": "livereload",
      "poll": 10,
      "onChange": "/code/bin/lb-on-change"
    },
    {
      "name": "signal",
      "poll": 10,
      "onChange": "/code/bin/lb-on-change"
    }
  ],
  "coprocesses": [{"command": "bin/check-cert"}],
  "tasks": [{"command": "bin/check-cert", "frequency": "12h"}]
}
